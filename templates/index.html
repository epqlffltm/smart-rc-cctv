<!DOCTYPE html>
<html>
<head>
    <title>Picar-X CCTV</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <style>
        body { text-align: center; font-family: sans-serif; background: #111; color: white; margin: 0; touch-action: manipulation; }
        #video-feed { width: 100%; max-width: 600px; margin-top: 5px; border: 2px solid #333; }
        .ui-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; padding: 15px; }
        .control-panel { background: #222; padding: 10px; border-radius: 15px; }
        .d-pad { display: grid; grid-template-columns: repeat(3, 1fr); gap: 5px; width: 180px; margin: 0 auto; }
        .btn { padding: 20px 0; background: #444; color: white; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; user-select: none; }
        .btn:active { background: #888; }
        .btn-rec { background: #900; grid-column: span 3; margin-top: 10px; padding: 10px; }
        .btn-storage { background: #28a745; width: 100%; margin-top: 10px; padding: 15px; }
    </style>
</head>
<body>
    <img id="video-feed" src="">
    <div class="ui-grid">
        <div class="control-panel">
            <h3>DRIVE</h3>
            <div class="d-pad">
                <div></div><button class="btn" onmousedown="sendMove('forward')" onmouseup="sendMove('stop')" ontouchstart="sendMove('forward')" ontouchend="sendMove('stop')">‚ñ≤</button><div></div>
                <button class="btn" onmousedown="sendMove('left')" onmouseup="sendMove('stop')" ontouchstart="sendMove('left')" ontouchend="sendMove('stop')">‚óÄ</button>
                <button class="btn" onclick="sendMove('stop')">‚ñ†</button>
                <button class="btn" onmousedown="sendMove('right')" onmouseup="sendMove('stop')" ontouchstart="sendMove('right')" ontouchend="sendMove('stop')">‚ñ∂</button>
                <div></div><button class="btn" onmousedown="sendMove('backward')" onmouseup="sendMove('stop')" ontouchstart="sendMove('backward')" ontouchend="sendMove('stop')">‚ñº</button><div></div>
            </div>
        </div>
        <div class="control-panel">
            <h3>CAMERA</h3>
            <div class="d-pad">
                <div></div><button class="btn" onclick="sendCam('up')">UP</button><div></div>
                <button class="btn" onclick="sendCam('left')">LEFT</button>
                <button class="btn" onclick="sendCam('center')">MID</button>
                <button class="btn" onclick="sendCam('right')">RIGHT</button>
                <div></div><button class="btn" onclick="sendCam('down')">DOWN</button><div></div>
            </div>
            <button id="recBtn" class="btn btn-rec" onclick="toggleRecord()">REC START</button>
        </div>
        <div style="grid-column: span 2;">
            <button class="btn btn-storage" onclick="location.href='/videos'">üìÇ ÏòÅÏÉÅ Î≥¥Í¥ÄÌï® Ïó¥Í∏∞ (1.4TB)</button>
        </div>
    </div>
    <script>
        document.getElementById('video-feed').src = "http://" + window.location.hostname + ":9000/mjpg";
        function sendMove(cmd) { fetch(`/move?cmd=${cmd}`); }
        function sendCam(cmd) { fetch(`/camera?cmd=${cmd}`); }
        let isRecording = false;
        function toggleRecord() {
            isRecording = !isRecording;
            const btn = document.getElementById('recBtn');
            btn.innerText = isRecording ? "REC STOP" : "REC START";
            btn.style.background = isRecording ? "#444" : "#900";
            fetch(`/record?status=${isRecording ? 'start' : 'stop'}`);
        }
        window.oncontextmenu = function(e) { e.preventDefault(); return false; };
    </script>
</body>
</html>