<!DOCTYPE html>
<html>
<head>
    <title>Picar-X CCTV Pro</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <style>
        body { text-align: center; font-family: sans-serif; background: #111; color: white; margin: 0; touch-action: manipulation; }
        #video-feed { width: 100%; max-width: 800px; border-bottom: 3px solid #333; }
        .grid-container { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; padding: 10px; }
        .card { background: #222; padding: 15px; border-radius: 12px; }
        .d-pad { display: grid; grid-template-columns: repeat(3, 1fr); gap: 5px; width: 150px; margin: 0 auto; }
        .btn { padding: 15px 0; background: #444; color: white; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; }
        .btn:active { background: #777; }
        .btn-rec { background: #900; width: 100%; margin-top: 15px; }
        .btn-auto { background: #0056b3; width: 100%; margin-bottom: 10px; }
        .btn-link { background: #28a745; width: 95%; padding: 15px; margin-top: 10px; display: inline-block; text-decoration: none; color: white; font-weight: bold; border-radius: 8px; }
    </style>
</head>
<body>
    <img id="video-feed" src="">
    <div class="grid-container">
        <div class="card">
            <h3>DRIVE</h3>
            <div class="d-pad">
                <div></div><button class="btn" onmousedown="move('forward')" onmouseup="move('stop')" ontouchstart="move('forward')" ontouchend="move('stop')">‚ñ≤</button><div></div>
                <button class="btn" onmousedown="move('left')" onmouseup="move('stop')" ontouchstart="move('left')" ontouchend="move('stop')">‚óÄ</button>
                <button class="btn" onclick="move('stop')">‚ñ†</button>
                <button class="btn" onmousedown="move('right')" onmouseup="move('stop')" ontouchstart="move('right')" ontouchend="move('stop')">‚ñ∂</button>
                <div></div><button class="btn" onmousedown="move('backward')" onmouseup="move('stop')" ontouchstart="move('backward')" ontouchend="move('stop')">‚ñº</button><div></div>
            </div>
        </div>
        <div class="card">
            <h3>SMART & CAM</h3>
            <button id="autoBtn" class="btn btn-auto" onclick="toggleAuto()">SMART MODE: OFF</button>
            <div class="d-pad">
                <div></div><button class="btn" onclick="cam('up')">U</button><div></div>
                <button class="btn" onclick="cam('left')">L</button>
                <button class="btn" onclick="cam('center')">M</button>
                <button class="btn" onclick="cam('right')">R</button>
                <div></div><button class="btn" onclick="cam('down')">D</button><div></div>
            </div>
            <button id="recBtn" class="btn btn-rec" onclick="toggleRecord()">REC START</button>
        </div>
    </div>
    <a href="/videos" class="btn-link">üìÇ 1.4TB ÏòÅÏÉÅ Î≥¥Í¥ÄÌï® (Ïû¨ÏÉù/Îã§Ïö¥Î°úÎìú)</a>

    <script>
        document.getElementById('video-feed').src = "http://" + window.location.hostname + ":9000/mjpg";
        function move(c) { fetch(`/move?cmd=${c}`); }
        function cam(c) { fetch(`/camera?cmd=${c}`); }
        
        let autoOn = false;
        function toggleAuto() {
            autoOn = !autoOn;
            const b = document.getElementById('autoBtn');
            b.innerText = autoOn ? "SMART MODE: ON" : "SMART MODE: OFF";
            b.style.background = autoOn ? "#28a745" : "#0056b3";
            fetch(`/auto_mode?status=${autoOn ? 'on' : 'off'}`);
        }

        let recOn = false;
        function toggleRecord() {
            recOn = !recOn;
            const b = document.getElementById('recBtn');
            b.innerText = recOn ? "REC STOP" : "REC START";
            b.style.background = recOn ? "#444" : "#900";
            fetch(`/record?status=${recOn ? 'start' : 'stop'}`);
        }
    </script>
</body>
</html>